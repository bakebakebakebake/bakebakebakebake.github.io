<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/waze.svg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/waze.svg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="vbZ7touwAx2j0hEDex2WavfpL8NiCRa-6Tn1cQbRtf8">
  <meta name="baidu-site-verification" content="f1d5bcefa8482d6d527c69831a4fbc61">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"fxj.wiki","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":"livere","storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="summary: Div2-Easy: Alice‚Äôs Birthday For a given , we have to partition the first fibonacci numbers in two set...... #### Div2-Easy: Alice‚Äôs Birthday For a given , we have to partition the first fi">
<meta property="og:type" content="article">
<meta property="og:title" content="Single Round Match 790 Editorials - Topcoder">
<meta property="og:url" content="https://fxj.wiki/posts/d6976ad7/index.html">
<meta property="og:site_name" content="FXJFXJ">
<meta property="og:description" content="summary: Div2-Easy: Alice‚Äôs Birthday For a given , we have to partition the first fibonacci numbers in two set...... #### Div2-Easy: Alice‚Äôs Birthday For a given , we have to partition the first fi">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-12-18T07:14:09.000Z">
<meta property="article:modified_time" content="2024-02-11T08:25:28.381Z">
<meta property="article:author" content="FXJFXJ">
<meta property="article:tag" content="div2">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://fxj.wiki/posts/d6976ad7/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.css"><style>
#needsharebutton-postbottom {
  cursor: pointer;
  height: 26px;
  margin-top: 10px;
  position: relative;
}
#needsharebutton-postbottom .btn {
  border: 1px solid $btn-default-border-color;
  border-radius: 3px;
  display: initial;
  padding: 1px 4px;
}
</style>
  <title>Single Round Match 790 Editorials - Topcoder | FXJFXJ</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?f1d5bcefa8482d6d527c69831a4fbc61";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="ÂàáÊç¢ÂØºËà™Ê†è">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">FXJFXJ</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>È¶ñÈ°µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>ÂÖ≥‰∫é</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Ê†áÁ≠æ</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>ÂàÜÁ±ª</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>ÂΩíÊ°£</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>ÊêúÁ¥¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="ÊêúÁ¥¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/bakebakebakebake" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

  

  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://fxj.wiki/posts/d6976ad7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/8e78b9e9e316fb38c4483af628530815.jpg">
      <meta itemprop="name" content="FXJFXJ">
      <meta itemprop="description" content="A story about ACMer and Programmerüòá">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FXJFXJ">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Single Round Match 790 Editorials - Topcoder
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">ÂèëË°®‰∫é</span>

              <time title="ÂàõÂª∫Êó∂Èó¥Ôºö2023-12-18 15:14:09" itemprop="dateCreated datePublished" datetime="2023-12-18T15:14:09+08:00">2023-12-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Êõ¥Êñ∞‰∫é</span>
                <time title="‰øÆÊîπÊó∂Èó¥Ôºö2024-02-11 16:25:28" itemprop="dateModified" datetime="2024-02-11T16:25:28+08:00">2024-02-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">ÂàÜÁ±ª‰∫é</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ACM/" itemprop="url" rel="index"><span itemprop="name">ACM</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="ÈòÖËØªÊ¨°Êï∞" id="busuanzi_container_page_pv" >
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">ÈòÖËØªÊ¨°Êï∞Ôºö</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="Êú¨ÊñáÂ≠óÊï∞">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Êú¨ÊñáÂ≠óÊï∞Ôºö</span>
              <span>5.9k</span>
            </span>
            <span class="post-meta-item" title="ÈòÖËØªÊó∂Èïø">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">ÈòÖËØªÊó∂Èïø &asymp;</span>
              <span>21 ÂàÜÈíü</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>summary: Div2-Easy: Alice‚Äôs Birthday For a given , we have to
partition the first fibonacci numbers in two set...... #### Div2-Easy:
Alice‚Äôs Birthday</p>
<p>For a given , we have to partition the first fibonacci numbers in two
sets with equal sum. The fact that means that if is a multiple of 3,
then I can give to Charlie and to Eric, to Charlie and to Eric, so on
and so forth eventually giving to Charlie and to Eric. The other two
cases are and .</p>
<p>For the first case, let us try to re-use our previous strategy for
the last boxes starting with going to Charlie and to Eric. In the end,
we will be left with the first two boxes containing and , respectively.
Since, so we can simply give one box to Charlie and other one to
Eric.</p>
<p>For the second case, we can try our previous strategy but will always
be left with one extra box. The fact that the sum of is odd means that
we cannot divide them <em>evenly</em> among Charlie and Eric. Had it
been possible to divide it equally, it would mean that the total sum is
even, which is not possible and can be proven using induction.</p>
<p>Since we only have to run a loop till , so time complexity is .</p>
<p>Reference sol in Java</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import java.io.*; </span><br><span class="line">import java.util.*; </span><br><span class="line">import javafx.util.Pair;</span><br><span class="line"></span><br><span class="line">public class AlicesBirthday &#123;</span><br><span class="line">    public int[] partition(int k) &#123;</span><br><span class="line">	int[] arr = &#123;-1&#125; ;</span><br><span class="line">	if(k % 3 == 1) return arr ; </span><br><span class="line">	</span><br><span class="line">        ArrayList&lt;Integer&gt; charlie = new ArrayList&lt;Integer&gt;(), eric = new ArrayList&lt;Integer&gt;(); </span><br><span class="line">	while(k &gt; 2) &#123;</span><br><span class="line">	    charlie.add(k--);</span><br><span class="line">	    eric.add(k--); eric.add(k--);</span><br><span class="line">	&#125;</span><br><span class="line">	if(k == 2) &#123; </span><br><span class="line">	    eric.add(k--);</span><br><span class="line">	    charlie.add(k--);</span><br><span class="line">	&#125;</span><br><span class="line">	int[] ret = new int[charlie.size()]; int index = 0;</span><br><span class="line">	for (Integer value: charlie) </span><br><span class="line">   		ret[index++] = value;</span><br><span class="line">	return ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Reference sol in Python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">class AlicesBirthday:</span><br><span class="line">	def partition(self, K):</span><br><span class="line">		F = [1, 1]</span><br><span class="line">		while len(F) &lt; K: F.append( F[-1] + F[-2] )</span><br><span class="line">		F = F[:K]</span><br><span class="line">		charlie, eric, answer = 0, 0, []</span><br><span class="line">		for k in reversed(range(K)):</span><br><span class="line">			if charlie &gt; eric:</span><br><span class="line">				eric += F[k]</span><br><span class="line">			else:</span><br><span class="line">				charlie += F[k]</span><br><span class="line">				answer.append(k+1)</span><br><span class="line">		if charlie == eric:</span><br><span class="line">			return answer</span><br><span class="line">		return [-1]</span><br></pre></td></tr></table></figure>
<h4 id="div2-medium-bob-the-builder">Div2-Medium: Bob the Builder</h4>
<p>Suppose we are at the given height . At any step, we can either move
to one of its factors or add to it. While we can move to its factors
without any cost, we have to spend $ to add . So, basically, we have a
given state, few possible options from there, and we want to find out
end whether a specific end state (i.e. height ) is reachable or not. If
reachable, we have to do so in minimum cost. This naturally appeals to
be modeled by graphs with states representing the nodes and edges
representing the transitions. Thus, we have to find the shortest path in
a graph, so Dijkstra definitely comes as the first solution in mind.</p>
<p>One may use Dijkstra to solve the problem, but it is not immediately
clear when to stop exploring if there does not exist any path. We would
never actually need to go beyond (<strong>proof is shown
below</strong>). But going so high, Dijkstra may get TLE. The fact that
edge weights are only and means that we can use instead of Dijkstra and
the time limit was high enough to allow that in case exploration goes so
high. However, in practice, the max step explored before reaching a goal
seems to be quite low (the worst case we could find was not more than );
hence normal Dijkstra passes easily.</p>
<p>Reference sol in Java using 0-1 BFS</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">import java.util.*;</span><br><span class="line">import java.lang.*;</span><br><span class="line">import java.io.*;</span><br><span class="line"></span><br><span class="line">public class BobtheBuilder &#123;</span><br><span class="line">    public int N = (int) 5e5 + 2 ; </span><br><span class="line">    public int maxStep = -1 ; </span><br><span class="line">    public List &lt;Integer&gt;[] factors = new ArrayList[N];</span><br><span class="line">    public int dist[] = new int[N] ; </span><br><span class="line">    public boolean seen[] = new boolean[N] ; </span><br><span class="line">    </span><br><span class="line">    void prep() &#123;</span><br><span class="line">	    for(int i = 1; i &lt; N; i++) &#123;</span><br><span class="line">	        factors[i] = new ArrayList&lt;Integer&gt; (); </span><br><span class="line">	        dist[i] = (int) 2e9 ; seen[i] = false ; </span><br><span class="line">	        int sq = (int) Math.sqrt(i);</span><br><span class="line">	        for(int j = 1; j &lt;= sq; j++) &#123;</span><br><span class="line">	            if(i % j == 0) &#123;</span><br><span class="line">	                factors[i].add(j); factors[i].add(i/j);</span><br><span class="line">	            &#125;</span><br><span class="line">	        &#125;</span><br><span class="line">	    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    public int minimumPrice(int b, int k, int h) &#123;</span><br><span class="line">	prep();</span><br><span class="line">        Deque&lt;Integer&gt; deq = new ArrayDeque&lt;Integer&gt;(); // seen[b] = true ; </span><br><span class="line">        dist[b] = 0 ;</span><br><span class="line">        deq.addFirst(b);</span><br><span class="line">        while(deq.size() &gt; 0) &#123;</span><br><span class="line">            int top = deq.removeFirst(); if(top &gt; maxStep) maxStep = top ; </span><br><span class="line">            if(top == h) return dist[top] ;</span><br><span class="line">            for(int f : factors[top]) &#123;</span><br><span class="line">                if(dist[top] &lt; dist[f]) &#123;</span><br><span class="line">                    deq.addFirst(f);</span><br><span class="line">                    dist[f] = dist[top] ; </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if( (top + k) &lt; N) &#123;</span><br><span class="line">                if( (dist[top] + 1) &lt; dist[top + k]) &#123;</span><br><span class="line">                    dist[top + k] = dist[top] + 1 ;</span><br><span class="line">                    deq.addLast(top + k); </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return -1 ; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Reference sol in C++ using Dijkstra</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;bits/stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">struct record &#123;</span><br><span class="line">    int id;</span><br><span class="line">    int dist;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">bool operator&lt;(const record &amp;A, const record &amp;B) &#123;</span><br><span class="line">    if (A.dist != B.dist) return A.dist &lt; B.dist;</span><br><span class="line">    return A.id &lt; B.id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int solve(int start, int add, int goal) &#123;</span><br><span class="line">    int div = __gcd(add,goal);</span><br><span class="line">    if (start % div) return -1;</span><br><span class="line"></span><br><span class="line">    vector&lt;int&gt; D(1002000,2000000);</span><br><span class="line">    D[start] = 0;</span><br><span class="line">    set&lt;record&gt; Q;</span><br><span class="line">    Q.insert( &#123;start, 0&#125; );</span><br><span class="line">    while (!Q.empty()) &#123;</span><br><span class="line">        record kde = *Q.begin();</span><br><span class="line">        Q.erase( Q.begin() );</span><br><span class="line">        if (kde.id &gt;= 1002000) continue;</span><br><span class="line">        if (kde.id == goal) break;</span><br><span class="line">        for (int div=1; div*div&lt;=kde.id; ++div) if (kde.id % div == 0) &#123;</span><br><span class="line">            vector&lt;int&gt; opts = &#123;div, kde.id/div&#125;;</span><br><span class="line">            for (int kam : opts) &#123;</span><br><span class="line">                int ndist = kde.dist;</span><br><span class="line">                if (ndist &gt;= D[kam]) continue;</span><br><span class="line">                Q.erase( &#123;kam, D[kam]&#125; );</span><br><span class="line">                D[kam] = ndist;</span><br><span class="line">                Q.insert( &#123;kam, D[kam]&#125; );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        vector&lt;int&gt; opts = &#123; kde.id + add &#125;;</span><br><span class="line">        for (int kam : opts) &#123;</span><br><span class="line">            int ndist = kde.dist + 1;</span><br><span class="line">            if (ndist &gt;= D[kam]) continue;</span><br><span class="line">            Q.erase( &#123;kam, D[kam]&#125; );</span><br><span class="line">            D[kam] = ndist;</span><br><span class="line">            Q.insert( &#123;kam, D[kam]&#125; );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (D[goal] == 2000000) return -1;</span><br><span class="line">    return D[goal];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">struct BobtheBuilder &#123;</span><br><span class="line">    int minimumPrice(int B, int K, int H) &#123; return solve(B,K,H); &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>Proof</strong><br />
If we are at some state , then at anytime, we can go to one of its
factors (possibly itself) or add . We do this starting from until we
reach . Suppose it is possible to reach , then thinking about the
process in reverse is basically from we can go to one of its
<em>multiple</em> (possibly itself) or subtract and continue this loop
until we reach . Thus, we can model this in the following form:</p>
<p>Simplifying this, we reduce it to a well-known form:</p>
<p>So, we end up with a linear diophantine equation. Let</p>
<p>. This is only solvable when</p>
<p>so we can instantly return -1 if</p>
<p>is not a multiple of</p>
<p>. The fact that</p>
<p>have opposite signs means that this admits infinite positive
solutions. From</p>
<p><em>Bezuot‚Äôs Identity</em></p>
<p>, we can always find a pair</p>
<p>such that</p>
<p>and</p>
<p>. So we can always find</p>
<p>lie in the range</p>
<p>and since infinite positive solutions are possible and we can
shift</p>
<p>, so it‚Äôs always possible to find a pair</p>
<p>with both lying in</p>
<p>. Since</p>
<p>, so the max state we need to explore to ensure we always find a
solution is bounded by</p>
<p>. Once we reach</p>
<p>from</p>
<p>, we can repeat the same process to reach</p>
<p>from</p>
<p>. While we did the derivation in the reverse form, it obviously holds
in the forward manner starting from</p>
<p>. Some useful links:</p>
<ol type="1">
<li><a
target="_blank" rel="noopener" href="https://math.stackexchange.com/questions/670405/does-the-extended-euclidean-algorithm-always-return-the-smallest-coefficients-of">Details
on Bezout‚Äôs Identity</a></li>
<li><a
target="_blank" rel="noopener" href="https://math.stackexchange.com/questions/1470541/existence-of-positive-solution-of-a-diophantine-equation">Positive
Solution of Linear Diophantine Eq</a></li>
</ol>
<h4 id="div2-hard-div1-easy-the-social-network">Div2-Hard / Div1-Easy:
The Social Network</h4>
<p>We are given an undirected connected graph with exponential weights
of the form , and we have to find its minimum cut. The problem may look
intimidating but what is in favor for us is the fact that <em>all edge
weights are distinct</em>.</p>
<p>Let the given weights sorted in decreasing order be (i.e. edge weight
is ). Then, for any valid between and , we have</p>
<p><img
src="https://www.topcoder.com/wp-content/uploads//2020/09/image-14-1024x145.png" /></p>
<p>So, we would like to keep the edge with the highest weight <em>out of
the cut edges set</em> at the cost of ending up with all other edges in
the cut since their total sum is <em>strictly</em> less than the highest
weight. Thus, we can keep adding edges one by one in the graph (in
decreasing order of their weight) as long as <em>one whole connected
component</em> does not form.</p>
<p>The edges which do not get added in the graph form our <em>cut
edges</em>, and their sum is the answer. This can be done by DSU but was
not required since the constraints were significantly small. If we do
use DSU, then sorting dominates the runtime with total complexity as
.</p>
<p>Reference Sol in Java</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">import java.util.*;</span><br><span class="line">import java.lang.*;</span><br><span class="line">import java.io.*;</span><br><span class="line"></span><br><span class="line">public class TheSocialNetwork &#123;</span><br><span class="line">    </span><br><span class="line">    class Edge implements Comparable&lt;Edge&gt; &#123;</span><br><span class="line">        public int u;</span><br><span class="line">        public int v;</span><br><span class="line">        public int w;</span><br><span class="line">        </span><br><span class="line">        public Edge(int uu, int vv, int cc) &#123;</span><br><span class="line">            this.u = uu;</span><br><span class="line">            this.v = vv;</span><br><span class="line">            this.w = cc;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        public int compareTo(Edge c) &#123;</span><br><span class="line">            if (w &lt; c.w) return 1;</span><br><span class="line">            if (w &gt; c.w) return -1;</span><br><span class="line">            return 0;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    int M = 1002 ; int C = 100002 ; int N = 302 ; </span><br><span class="line">    List &lt;Edge&gt; edges = new ArrayList&lt;Edge&gt;() ; </span><br><span class="line">    int[] par = new int[N] ; int[] sz = new int[N] ; int[] pwr = new int[C] ; </span><br><span class="line">    int MOD = (int) (1e9 + 7); int comp ; </span><br><span class="line">    </span><br><span class="line">    boolean[] seen = new boolean[C] ;</span><br><span class="line">    List &lt; Integer &gt;[] adj = new ArrayList[N] ; </span><br><span class="line">    boolean[] visited = new boolean[N] ;</span><br><span class="line">    int connected ;</span><br><span class="line">    </span><br><span class="line">    void prepare() &#123;</span><br><span class="line">        pwr[0] = 1 ; seen[0] = false ; </span><br><span class="line">        for(int i = 1; i &lt; C; i++) &#123;</span><br><span class="line">            pwr[i] = (pwr[i-1] * 2) % MOD ;</span><br><span class="line">            seen[i] = false ;</span><br><span class="line">        &#125;</span><br><span class="line">        for(int i = 1; i &lt; N; i++) &#123;</span><br><span class="line">            par[i] = i ; sz[i] = 1 ;</span><br><span class="line">            adj[i] = new ArrayList&lt;Integer&gt;(); </span><br><span class="line">            visited[i] = false ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    int getPar(int v) &#123;</span><br><span class="line">        if(par[v] == v) return v ;</span><br><span class="line">        else return par[v] = getPar(par[v]); </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    int dsu(int u, int v) &#123;</span><br><span class="line">        int parU = getPar(u) ; int parV = getPar(v);</span><br><span class="line">        if(parU == parV) return 0;</span><br><span class="line">        </span><br><span class="line">        if(sz[u] &lt; sz[v]) &#123; // swap</span><br><span class="line">            u ^= v ; v ^= u ; u ^= v ; </span><br><span class="line">        &#125;</span><br><span class="line">        sz[u] += sz[v] ;</span><br><span class="line">        par[parV] = parU ; </span><br><span class="line">        return 1 ;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public int minimumCut(int n, int m, int[] u, int[] v, int[] l) &#123;</span><br><span class="line">        prepare();</span><br><span class="line">        for(int i = 0; i &lt; m; i++) &#123;</span><br><span class="line">            Edge e = new Edge(u[i], v[i], l[i]);</span><br><span class="line">            edges.add(e); </span><br><span class="line">        &#125;</span><br><span class="line">        Collections.sort(edges);</span><br><span class="line">        int ans = 0; comp = n ; </span><br><span class="line">        for(Edge e : edges) &#123;</span><br><span class="line">            System.out.println(e.w);</span><br><span class="line">            int parU = getPar(e.u) ; int parV = getPar(e.v);</span><br><span class="line">            if(parU == parV) &#123;</span><br><span class="line">            &#125;</span><br><span class="line">            else &#123;</span><br><span class="line">                if(comp &gt; 2) &#123; </span><br><span class="line">                    comp-- ;</span><br><span class="line">                    dsu(e.u, e.v);</span><br><span class="line">                &#125;</span><br><span class="line">                else &#123;</span><br><span class="line">                    ans += pwr[e.w] ; </span><br><span class="line">                    ans %= MOD ; </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return ans ; </span><br><span class="line">    &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Reference Sol in Python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">def pow2(n):</span><br><span class="line">	if n == 0: return 1</span><br><span class="line">	t = pow2(n//2)</span><br><span class="line">	t *= t</span><br><span class="line">	if n % 2: t *= 2</span><br><span class="line">	return t % 1000000007</span><br><span class="line"></span><br><span class="line">class TheSocialNetwork:</span><br><span class="line">	def minimumCut(self, n, m, u, v, l):</span><br><span class="line">		edges = [ (-z,x-1,y-1) for x,y,z in zip(u,v,l) ]</span><br><span class="line">                edges.sort()</span><br><span class="line">                component_count = n</span><br><span class="line">                component = list(range(n))</span><br><span class="line">		answer = 0</span><br><span class="line">		for w,x,y in edges:</span><br><span class="line">			if component[x] == component[y]: continue</span><br><span class="line">			if component_count == 2:</span><br><span class="line">				answer = (answer + pow2(-w)) % 1000000007</span><br><span class="line">			else:</span><br><span class="line">				cx, cy = component[x], component[y]</span><br><span class="line">				component = [ cx if c==cy else c for c in component ]</span><br><span class="line">				component_count -= 1</span><br><span class="line">		return answer</span><br></pre></td></tr></table></figure>
<p><em>Side Thought</em>: We were wondering whether it is possible to
solve this problem using <em>max-flow</em>?</p>
<h4 id="div1-medium-proposal-optimization">Div1-Medium: Proposal
Optimization</h4>
<p>Such kind of ratio problems can be solved by using a niche trick. I
think it is hard to develop this line of thinking unless you have
encountered it before.</p>
<p>Let us say the optimal ratio is . Thus, . What we can do is a binary
search on , and check if a ratio is feasible or not. So, for a given ,
we have to check whether is possible, which is the same thing as (let‚Äôs
call the L.H.S. ). The constraints on seem to be quite high to do any
form of <em>DP</em> while constraints on the grid‚Äôs dimension, are quite
low although obviously not permitting brute force solutions. However,
meet-in-the-middle looks promising since we can store while doing brute
force from one corner of the grid and checking from another (meeting in
cells lying on <em>some sort of diagonal</em> of the grid).</p>
<p>In fact, it is the intended solution, and we also have to take care
of the costs along with to actually know if any of the options is
actually feasible. So, when doing brute from one side, we store pairs on
<em>those diagonal cells</em> and later sort them according to to ease
our process in the next brute. While doing brute from the other end, we
have , and we want the highest whose cost satisfies . By storing in
prefix maximum manner, we can binary search on the highest index option
with cost and take its (since we already sorted) to get our answer.</p>
<p>The best diagonal cells for a grid of size would be the set . Since
x, so the number of <em>such diagonal</em> cells (let us denote that by
) can‚Äôt exceed . We can focus on the analysis of square matrix since it
will dominate the rectangular grids. Let the number of binary search
iterations required to find the optimal ratio be (80 iterations suffice
for error). To reach a diagonal cell there are ways and then we have to
binary search on those many paths which we got from first brute force.
Thus, doing meet-in-the-middle takes</p>
<p>Hence, the total time required is bounded by</p>
<p>.</p>
<p>Reference Sol in C++</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;bits/stdc++.h&gt;</span><br><span class="line">#include&lt;ext/pb_ds/assoc_container.hpp&gt;</span><br><span class="line">#include&lt;ext/pb_ds/tree_policy.hpp&gt;</span><br><span class="line"></span><br><span class="line">using namespace std ;</span><br><span class="line">using namespace __gnu_pbds;</span><br><span class="line"></span><br><span class="line">template &lt;typename T&gt; // *s.find_by_order(0), s.order_of_key(2) ;</span><br><span class="line">using ordered_set = tree&lt;T, null_type, less&lt;T&gt;, rb_tree_tag, tree_order_statistics_node_update&gt;;</span><br><span class="line"></span><br><span class="line">#define reMin(a, b) a = min(a, b)</span><br><span class="line">#define reMax(a, b) a = max(a, b)</span><br><span class="line"></span><br><span class="line">#define lint long long</span><br><span class="line">#define pb push_back</span><br><span class="line">#define F first </span><br><span class="line">#define S second </span><br><span class="line">#define sz(x) (int)x.size()</span><br><span class="line">#define all(x) begin(x), end(x)</span><br><span class="line">#define SET(x, val) memset(x, val, sizeof(x))</span><br><span class="line">#define fastio ios_base::sync_with_stdio(0); cin.tie(0); cout.tie(0)</span><br><span class="line"></span><br><span class="line">typedef vector &lt; int &gt; vi ;</span><br><span class="line">typedef pair &lt; int, int &gt; pii ;</span><br><span class="line"></span><br><span class="line">const int N = 300 + 2 ;</span><br><span class="line">const int MOD = 1e9 + 7 ;</span><br><span class="line">const lint INF = 1e18 ;</span><br><span class="line"></span><br><span class="line">double best = 0 ;</span><br><span class="line">int n, m, k ;</span><br><span class="line">int roses[N][N], tulips[N][N], cost[N][N] ;</span><br><span class="line"></span><br><span class="line">vector &lt; pair &lt; int, double &gt; &gt; meet[N][N] ;</span><br><span class="line">vector &lt; double &gt; ratios[N][N] ; </span><br><span class="line">int diagonal ;</span><br><span class="line">bool possible = 0 ;</span><br><span class="line">bool ratioSatisfied = 0 ; </span><br><span class="line"></span><br><span class="line">void down(int i, int j, int rose, int tulip, int totalCost, double&amp; R) &#123;</span><br><span class="line">	if(i &gt;= n or j &gt;= m) return ;</span><br><span class="line">	rose += roses[i][j] ; tulip += tulips[i][j] ; totalCost += cost[i][j] ; </span><br><span class="line">	if(totalCost &gt; k) return ; </span><br><span class="line">	if(i + j == diagonal) &#123;</span><br><span class="line">		double cur = rose ; cur -= R * tulip ; </span><br><span class="line">		meet[i][j].pb(&#123;totalCost, cur&#125;);</span><br><span class="line">		return ; </span><br><span class="line">	&#125;</span><br><span class="line">	down(i+1, j, rose, tulip, totalCost, R); down(i, j+1, rose, tulip, totalCost, R); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void up(int i, int j, int rose, int tulip, int totalCost, double&amp; R) &#123;</span><br><span class="line">	if(i &lt; 0 or j &lt; 0) return ;</span><br><span class="line">	rose += roses[i][j] ; tulip += tulips[i][j] ; totalCost += cost[i][j] ; </span><br><span class="line">	if(totalCost &gt; k) return ; </span><br><span class="line">	if(i + j == diagonal) &#123;</span><br><span class="line">		rose -= roses[i][j] ; tulip -= tulips[i][j] ; totalCost -= cost[i][j] ; </span><br><span class="line">		double cur = rose ; cur -= R * tulip ; </span><br><span class="line"></span><br><span class="line">		pair &lt; int, double &gt; item = &#123;k - totalCost, 2e9&#125; ;</span><br><span class="line">		int idx = upper_bound(all(meet[i][j]), item) - meet[i][j].begin();</span><br><span class="line">		idx-- ;</span><br><span class="line">		if(idx &gt;= 0) &#123;</span><br><span class="line">			possible = 1 ; assert(idx &lt; sz(ratios[i][j]) and sz(ratios[i][j]) == sz(meet[i][j]));</span><br><span class="line">			double mx = ratios[i][j][idx] ; </span><br><span class="line">			</span><br><span class="line">			if((mx + cur) &gt;= 0) // should be EPS!! </span><br><span class="line">				ratioSatisfied = 1 ; </span><br><span class="line">		&#125;</span><br><span class="line">		return ; </span><br><span class="line">	&#125;</span><br><span class="line">	up(i-1, j, rose, tulip, totalCost, R); up(i, j-1, rose, tulip, totalCost, R); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void check(double ratio) &#123;</span><br><span class="line">	down(0, 0, 0, 0, 0, ratio);</span><br><span class="line"></span><br><span class="line">	for(int i = 0; i &lt; n; i++) &#123;</span><br><span class="line">		int j = diagonal - i ;</span><br><span class="line">		if(j &gt;= m or j &lt; 0) continue ; </span><br><span class="line">		</span><br><span class="line">        if(sz(meet[i][j]) &lt;= 0) continue ; </span><br><span class="line">		sort(all(meet[i][j]));</span><br><span class="line"></span><br><span class="line">		ratios[i][j].pb(meet[i][j][0].S);</span><br><span class="line">		for(int p = 1; p &lt; sz(meet[i][j]); p++)</span><br><span class="line">			ratios[i][j].pb(max(meet[i][j][p].S, ratios[i][j].back()));</span><br><span class="line">	&#125;</span><br><span class="line">	up(n-1, m-1, 0, 0, 0, ratio);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">double solve() &#123;</span><br><span class="line">	double low = 0, high = 1e6 ; ratioSatisfied = 0 ;</span><br><span class="line">	</span><br><span class="line">	for(int iter = 0; iter &lt; 70; iter++) &#123;</span><br><span class="line">		double mid = (low + high) / 2 ;</span><br><span class="line">		check(mid); </span><br><span class="line">		if(ratioSatisfied) low = mid ;</span><br><span class="line">		else high = mid ;</span><br><span class="line">		</span><br><span class="line">		// clear stuff</span><br><span class="line">		ratioSatisfied = 0 ; </span><br><span class="line">		for(int i = 0; i &lt; n; i++) &#123;</span><br><span class="line">			int j = diagonal - i ;</span><br><span class="line">			if(j &lt; 0 or j &gt;= m) continue ; </span><br><span class="line">			ratios[i][j].clear(); meet[i][j].clear();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	return low ; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class ProposalOptimization &#123;</span><br><span class="line">public:</span><br><span class="line">	double bestPath(int rows, int cols, int K, vi roz,  vi tolip, vi expense);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">double ProposalOptimization::bestPath(int rows, int cols, int K, vi roz,  vi tolip, vi expense )&#123;</span><br><span class="line">	n = rows ; m = cols ; k = K ;</span><br><span class="line">	for(int i = 0; i &lt; n; i++) for(int j = 0; j &lt; m; j++) roses[i][j] = roz[i*cols + j] ; </span><br><span class="line">	for(int i = 0; i &lt; n; i++) for(int j = 0; j &lt; m; j++) tulips[i][j] = tolip[i* cols + j] ; </span><br><span class="line">	for(int i = 0; i &lt; n; i++) for(int j = 0; j &lt; m; j++) cost[i][j] = expense[i*cols + j] ; </span><br><span class="line">	double best = solve();</span><br><span class="line">	if(!possible) return -1 ;</span><br><span class="line">	else return best ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Reference Sol in Java</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">import java.util.*;</span><br><span class="line">import java.math.*;</span><br><span class="line"> </span><br><span class="line">public class ProposalOptimization &#123;</span><br><span class="line">    class Option implements Comparable&lt;Option&gt; &#123;</span><br><span class="line">        public int orchids;</span><br><span class="line">        public int tulips;</span><br><span class="line">        public int cost;</span><br><span class="line"> </span><br><span class="line">        public Option(int orchids, int tulips, int cost) &#123;</span><br><span class="line">            this.orchids = orchids;</span><br><span class="line">            this.tulips = tulips;</span><br><span class="line">            this.cost = cost;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        public int compareTo(Option c) &#123;</span><br><span class="line">            if (cost &lt; c.cost) return -1;</span><br><span class="line">            if (cost &gt; c.cost) return 1;</span><br><span class="line">            if (orchids &lt; c.orchids) return -1;</span><br><span class="line">            if (orchids &gt; c.orchids) return 1;</span><br><span class="line">            if (tulips &lt; c.tulips) return -1;</span><br><span class="line">            if (tulips &gt; c.tulips) return 1;</span><br><span class="line">            return 0;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    Option[][] getOptions(int[][] orchids, int[][] tulips, int[][] costs, int steps, boolean secondPass) &#123;</span><br><span class="line">        int R = orchids.length, C = orchids[0].length;</span><br><span class="line">        int[][] options = new int[][] &#123; &#123;0,0,0,0,0&#125; &#125;;</span><br><span class="line">        for (int d=1; d&lt;=steps; ++d) &#123;</span><br><span class="line">            int newOptionCount = 0;</span><br><span class="line">            for (int i=0; i&lt;options.length; ++i) &#123;</span><br><span class="line">                if (options[i][0] + 1 &lt; R) ++newOptionCount;</span><br><span class="line">                if (options[i][1] + 1 &lt; C) ++newOptionCount;</span><br><span class="line">            &#125;</span><br><span class="line">            int[][] newOptions = new int[newOptionCount][5];</span><br><span class="line">            for (int i=0, j=0; i&lt;options.length; ++i) &#123;</span><br><span class="line">                if (options[i][0] + 1 &lt; R) &#123;</span><br><span class="line">                    int r = newOptions[j][0] = options[i][0] + 1;</span><br><span class="line">                    int c = newOptions[j][1] = options[i][1];</span><br><span class="line">                    int mul = (secondPass &amp;&amp; d == steps) ? 0 : 1;</span><br><span class="line">                    newOptions[j][2] = options[i][2] + mul * orchids[r][c];</span><br><span class="line">                    newOptions[j][3] = options[i][3] + mul * tulips[r][c];</span><br><span class="line">                    newOptions[j][4] = options[i][4] + mul * costs[r][c];</span><br><span class="line">                    ++j;</span><br><span class="line">                &#125;</span><br><span class="line">                if (options[i][1] + 1 &lt; C) &#123;</span><br><span class="line">                    int r = newOptions[j][0] = options[i][0];</span><br><span class="line">                    int c = newOptions[j][1] = options[i][1] + 1;</span><br><span class="line">                    int mul = (secondPass &amp;&amp; d == steps) ? 0 : 1;</span><br><span class="line">                    newOptions[j][2] = options[i][2] + mul * orchids[r][c];</span><br><span class="line">                    newOptions[j][3] = options[i][3] + mul * tulips[r][c];</span><br><span class="line">                    newOptions[j][4] = options[i][4] + mul * costs[r][c];</span><br><span class="line">                    ++j;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            options = newOptions;</span><br><span class="line">        &#125;</span><br><span class="line">        int[] answerCounts = new int[R];</span><br><span class="line">        for (int i=0; i&lt;options.length; ++i) ++answerCounts[options[i][0]];</span><br><span class="line">        Option[][] answer = new Option[R][];</span><br><span class="line">        for (int r=0; r&lt;R; ++r) answer[secondPass ? R-1-r : r] = new Option[answerCounts[r]];</span><br><span class="line">        for (int i=0; i&lt;options.length; ++i) &#123;</span><br><span class="line">            int r = options[i][0];</span><br><span class="line">            answer[secondPass ? R-1-r : r][ --answerCounts[r] ] = new Option( options[i][2], options[i][3], options[i][4] );</span><br><span class="line">            // System.out.println(&quot;row &quot;+r+&quot; added option &quot;+options[i][2]+&quot; &quot;+options[i][3]+&quot; &quot;+options[i][4] );</span><br><span class="line">        &#125;</span><br><span class="line">        return answer;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    int[][] flip(int[][] array) &#123;</span><br><span class="line">        int R = array.length, C = array[0].length;</span><br><span class="line">        int[][] answer = new int[R][C];</span><br><span class="line">        for (int r=0; r&lt;R; ++r) for (int c=0; c&lt;C; ++c) answer[r][c] = array[R-1-r][C-1-c];</span><br><span class="line">        return answer;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    boolean solvable(double x, Option[] options1, Option[] options2, int K) &#123;</span><br><span class="line">        int b = 0;</span><br><span class="line">        double bestb = -1e20;</span><br><span class="line">        for (int a=options1.length-1; a&gt;=0; --a) &#123;</span><br><span class="line">            while (b &lt; options2.length &amp;&amp; options1[a].cost + options2[b].cost &lt;= K) &#123;</span><br><span class="line">                bestb = Math.max( bestb, options2[b].orchids - x * options2[b].tulips );</span><br><span class="line">                ++b;</span><br><span class="line">            &#125;</span><br><span class="line">            if (options1[a].orchids - x * options1[a].tulips + bestb &gt;= 0) return true;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public double bestPath(int R, int C, int K, int[] _orchids, int[] _tulips, int[] _costs) &#123;</span><br><span class="line"> </span><br><span class="line">        int[][] orchids = new int[R][C];</span><br><span class="line">        int[][] tulips = new int[R][C];</span><br><span class="line">        int[][] costs = new int[R][C];</span><br><span class="line">        for (int r=0; r&lt;R; ++r) for (int c=0; c&lt;C; ++c) &#123;</span><br><span class="line">            orchids[r][c] = _orchids[r*C + c];</span><br><span class="line">            tulips[r][c] = _tulips[r*C + c];</span><br><span class="line">            costs[r][c] = _costs[r*C + c];</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        Option[][] options1 = getOptions( orchids, tulips, costs, (R+C-2)/2, false);</span><br><span class="line">        Option[][] options2 = getOptions( flip(orchids), flip(tulips), flip(costs), (R+C-1)/2, true);</span><br><span class="line"> </span><br><span class="line">        for (int i=0; i&lt;options1.length; ++i) Arrays.sort(options1[i]);</span><br><span class="line">        for (int i=0; i&lt;options2.length; ++i) Arrays.sort(options2[i]);</span><br><span class="line"> </span><br><span class="line">        int bestCost = K+1;</span><br><span class="line">        for (int i=0; i&lt;options1.length; ++i) if (options1[i].length &gt; 0 &amp;&amp; options2[i].length &gt; 0) bestCost = Math.min( bestCost, options1[i][0].cost + options2[i][0].cost );</span><br><span class="line">        if (bestCost &gt; K) return -1;</span><br><span class="line"> </span><br><span class="line">        double lo = 0, hi = 1e6 + 1;</span><br><span class="line">        for (int step=0; step&lt;200; ++step) &#123;</span><br><span class="line">            double med = (lo+hi) / 2;</span><br><span class="line">            boolean isSolvable = false;</span><br><span class="line">            for (int i=0; i&lt;options1.length; ++i) if (solvable(med,options1[i],options2[i],K)) &#123;</span><br><span class="line">                isSolvable = true;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">            if (isSolvable) lo = med; else hi = med;</span><br><span class="line">        &#125;</span><br><span class="line">        return lo;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="div1-hard-tale-of-two-squares">Div1-Hard: Tale Of Two
Squares:</h4>
<p>#div1 A number can be expressed as a <em>sum of two sqaures</em> if
and only if all its prime factors of the form occur <em>even</em> times.
So while taking the product of few numbers, we are only interested in
its prime decomposition; hence, we can store a bit-vector for each <span
class="math inline">\(A_{i}\)</span> denoting <strong>odd/even</strong>
occurrence of such prime factors.</p>
<p>From now on, **whenever I talk about primes it is assumed to be of
the form <span class="math inline">\(4K+3\)</span> (for some <span
class="math inline">\(k \in Z\)</span> ) and that the reader is familar
with basis of a vector space and gaussian elimination. Please go through
this if you are not familiar with the usage of those concepts in
CP:<br />
<a target="_blank" rel="noopener" href="https://codeforces.com/blog/entry/68953">Introductory Blog on
using Linear Algebraic techniques to solve XOR related problems</a></p>
<p>Now, <span class="math inline">\(A_{i}‚â§10^7\)</span> so # primes is
around <span class="math inline">\(3‚àó10^5\)</span>. Normal Gaussian
elimination would easily TLE, even with bitsets. Still, lets imagine
doing Gaussian elimination traversing from the highest bit to the lowest
and xoring when necessary. Notice that, when you are traversing, if any
prime factor <span class="math inline">\(&gt;\sqrt{ A_{i} }\)</span>
exists (at max one can exist), the moment you xor it, no more bits <span
class="math inline">\(&gt;\sqrt{ A_{i} }\)</span> will be on anymore
(since only one such was on earlier and now you have xored it). Now, you
can simply simulate Gaussian elimination on lower-order primes (i.e.
primes<span class="math inline">\(‚â§\sqrt{ A_{i} }\)</span>) and handle
that one highest bit (if it exists) separately. This way, combined with
bitset for lower-order primes, solves the problem without queries.</p>
<p>For queries, let us process them offline. Let <span
class="math inline">\(queries[l]\)</span> store all the queries with
their left endpoint as <span class="math inline">\(l\)</span>. We will
insert <span class="math inline">\(A_{i}\)</span> into our basis from
the right side, <span class="math inline">\(i\)</span> going from <span
class="math inline">\(N‚àí1\)</span> to <span
class="math inline">\(0\)</span>. After we have inserted the element at
index <span class="math inline">\(i\)</span>, we will answer all the
queries which begin their, i.e., the ones in <span
class="math inline">\(queries[i]\)</span>.</p>
<p>We will use a simple fact about linear combination of vectors but in
a clever manner to answer the queries. Suppose we are about to try and
insert v into our <span class="math inline">\(Basis\)</span> (may not
insert if it turns out to be dependant). If <span
class="math inline">\(v=b _{1}+b _{2}+‚ãØb_{k} (where
b_{i}‚ààBasis)\)</span>, then we can remove one of the <span
class="math inline">\(b_i\)</span> and instead insert <span
class="math inline">\(v\)</span> into its place, keeping the basis
intact. So, we will use this fact while inserting ‚Äî we will try to keep
such elements in the basis which have leftmost index so as to answer as
many queries as possible. We can do this greedily: while inserting <span
class="math inline">\(v\)</span>, whenever we are about to xor it with
some <span class="math inline">\(b_i\)</span>, we will first check which
has the least index and <span class="math inline">\(swap (b_i,
v)\)</span> if <span class="math inline">\(v\)</span> ‚Äòs index is
smaller than <span class="math inline">\(b_i\)</span>. If we do end up
swapping, then <span class="math inline">\(v\)</span> becomes a part of
the basis (in place of <span class="math inline">\(b_i\)</span>), and we
progress doing Gaussian Elimination with <span
class="math inline">\(b_i\)</span> instead. Otherwise, we move forward
with v like we normally do. Please refer to the attached code for more
details.</p>
<p>Now, when we answer queries which have left index <span
class="math inline">\(i\)</span>, we will have the basis vectors from
<span class="math inline">\(A[i: N]\)</span> having the least possible
index. So for a query <span class="math inline">\(i\)</span> <span
class="math inline">\(R\)</span>, we simply need to count how many
vectors in our basis have index <span class="math inline">\(‚â§R\)</span>.
This can be easily done with some BIT or set.</p>
<p>Let <span class="math inline">\(K\)</span> denote the number of
primes <span class="math inline">\(\leq \sqrt{ A_{i} }\)</span><span
class="math inline">\((=225)\)</span>. We store a bitset of size <span
class="math inline">\(K\)</span> for every prime. While doing Gaussian
elimination, we handle the large bit manually while following the normal
procedure for lower-order primes; hence it takes <span
class="math inline">\(O (\frac{K^2}{64})\)</span> time to insert a <span
class="math inline">\(A_i\)</span>. After that, we answer queries at
index i in <span class="math inline">\(O (log (N))\)</span> time by
querying in our BIT. Hence, the overall complexity is <span
class="math inline">\(O \left( N‚ãÖ \frac{k^2}{64}+Q‚ãÖlog (N)
\right)\)</span>, dominated by Gaussian elimination using bitsets:</p>
<p>‰∏Ä‰∏™Êï∞Â≠óÂèØ‰ª•Ë¢´Ë°®Á§∫‰∏∫‰∏§‰∏™Âπ≥ÊñπÊï∞ÁöÑÂíåÔºåÂΩì‰∏î‰ªÖÂΩìÂÆÉÊâÄÊúâÂΩ¢Âºè‰∏∫ <span
class="math inline">\(4K+3\)</span>
ÁöÑË¥®Âõ†Êï∞Âá∫Áé∞ÂÅ∂Êï∞Ê¨°„ÄÇÊâÄ‰ª•ÔºåÂΩìÊàë‰ª¨ËÆ°ÁÆóÂá†‰∏™Êï∞Â≠óÁöÑ‰πòÁßØÊó∂ÔºåÊàë‰ª¨Âè™ÂÖ≥ÂøÉÂÆÉÁöÑË¥®Âõ†Êï∞ÂàÜËß£ÔºõÂõ†Ê≠§ÔºåÊàë‰ª¨ÂèØ‰ª•‰∏∫ÊØè‰∏™
<span class="math inline">\(A_{i}\)</span>
Â≠òÂÇ®‰∏Ä‰∏™‰ΩçÂêëÈáèÔºåË°®Á§∫Ëøô‰∫õË¥®Âõ†Êï∞ÁöÑÂ•áÊï∞/ÂÅ∂Êï∞Âá∫Áé∞„ÄÇ</p>
<p>‰ªéÁé∞Âú®ÂºÄÂßãÔºå<strong>ÊØèÂΩìÊàëË∞àÂà∞Ë¥®Êï∞Êó∂ÔºåÂÅáÂÆöÂÆÉ‰ª¨‰∏∫ÂΩ¢Âºè‰∏∫ <span
class="math inline">\(4K+3\)</span>ÔºàÂØπ‰∫éÊüê‰∏™ <span
class="math inline">\(k \in
Z\)</span>ÔºâÔºåÂπ∂‰∏îËØªËÄÖÁÜüÊÇâÂêëÈáèÁ©∫Èó¥ÁöÑÂü∫Á°ÄÂíåÈ´òÊñØÊ∂àÂÖÉ„ÄÇÂ¶ÇÊûúÊÇ®ÂØπÂú®Á´ûËµõÁºñÁ®ã‰∏≠Â¶Ç‰ΩïÂ∫îÁî®Ëøô‰∫õÊ¶ÇÂøµ‰∏çÁÜüÊÇâÔºåËØ∑ÈòÖËØªËøôÁØáÊñáÁ´†Ôºö<a
target="_blank" rel="noopener" href="https://codeforces.com/blog/entry/68953">‰ΩøÁî®Á∫øÊÄß‰ª£Êï∞ÊäÄÊúØËß£ÂÜ≥ÂºÇÊàñÁõ∏ÂÖ≥ÈóÆÈ¢òÁöÑÂÖ•Èó®ÂçöÂÆ¢</a></strong></p>
<p>Áé∞Âú®Ôºå<span
class="math inline">\(A_{i}‚â§10^7\)</span>ÔºåÂõ†Ê≠§Ë¥®Êï∞ÁöÑÊï∞ÈáèÂ§ßÁ∫¶‰∏∫ <span
class="math inline">\(3‚àó10^5\)</span>„ÄÇÊôÆÈÄöÁöÑÈ´òÊñØÊ∂àÂÖÉÁîöËá≥‰ΩøÁî®‰ΩçÈõÜÂêà‰πüÂèØËÉΩÂæàÂÆπÊòìË∂ÖÊó∂„ÄÇ‰∏çËøáÔºåËÆ©Êàë‰ª¨ÂÅáËÆæ‰ªéÊúÄÈ´ò‰ΩçÂà∞ÊúÄ‰Ωé‰ΩçËøõË°åÈ´òÊñØÊ∂àÂÖÉÂπ∂Âú®ÂøÖË¶ÅÊó∂ËøõË°åÂºÇÊàñÊìç‰Ωú„ÄÇÊ≥®ÊÑèÔºåÂΩìÊÇ®ÈÅçÂéÜÊó∂ÔºåÂ¶ÇÊûúÂ≠òÂú®‰ªª‰ΩïÂ§ß‰∫é
<span class="math inline">\(\sqrt{ A_{i} }\)</span>
ÁöÑË¥®Âõ†Êï∞ÔºàÊúÄÂ§öÂèØ‰ª•Â≠òÂú®‰∏Ä‰∏™ÔºâÔºå‰∏ÄÊó¶ÂºÇÊàñ‰∫ÜÂÆÉÔºåÂ∞±‰∏ç‰ºöÂÜçÊúâÂ§ß‰∫é <span
class="math inline">\(\sqrt{ A_{i} }\)</span>
ÁöÑ‰Ωç‰∫ÜÔºàÂõ†‰∏∫‰πãÂâçÂè™Êúâ‰∏Ä‰∏™‰ΩçÊòØÊâìÂºÄÁöÑÔºåÁé∞Âú®ÊÇ®Â∑≤ÁªèÂºÇÊàñ‰∫ÜÂÆÉÔºâ„ÄÇÁé∞Âú®ÔºåÊÇ®ÂèØ‰ª•ÁÆÄÂçïÂú∞Ê®°ÊãüÂØπ‰ΩéÈò∂Ë¥®Êï∞ÔºàÂç≥Ë¥®Êï∞
<span class="math inline">\(‚â§\sqrt{ A_{i}
}\)</span>ÔºâËøõË°åÈ´òÊñØÊ∂àÂÖÉÔºåÂπ∂ÂçïÁã¨Â§ÑÁêÜÈÇ£‰∏™ÊúÄÈ´ò‰ΩçÔºàÂ¶ÇÊûúÂ≠òÂú®ÁöÑËØùÔºâ„ÄÇËøôÊ†∑ÔºåÁªìÂêàÂØπ‰ΩéÈò∂Ë¥®Êï∞ÁöÑ‰ΩçÈõÜÂêàÂ§ÑÁêÜÔºåÂ∞±ÂèØ‰ª•Ëß£ÂÜ≥ÈóÆÈ¢ò„ÄÇ</p>
<p>ÂØπ‰∫éÊü•ËØ¢ÔºåËÆ©Êàë‰ª¨Á¶ªÁ∫øÂ§ÑÁêÜÂÆÉ‰ª¨„ÄÇËÆ© <span
class="math inline">\(queries[l]\)</span> Â≠òÂÇ®ÊâÄÊúâÂ∑¶Á´ØÁÇπ‰∏∫ <span
class="math inline">\(l\)</span> ÁöÑÊü•ËØ¢„ÄÇÊàë‰ª¨Â∞Ü‰ªéÂè≥‰æßÂ∞Ü <span
class="math inline">\(A_{i}\)</span> ÊèíÂÖ•Âà∞Êàë‰ª¨ÁöÑÂü∫ÂêëÈáè‰∏≠ÔºåÂÖ∂‰∏≠ <span
class="math inline">\(i\)</span> ‰ªé <span
class="math inline">\(N-1\)</span> Âà∞ <span
class="math inline">\(0\)</span>„ÄÇÂú®Êàë‰ª¨ÊèíÂÖ•Á¥¢Âºï <span
class="math inline">\(i\)</span>
Â§ÑÁöÑÂÖÉÁ¥†‰πãÂêéÔºåÊàë‰ª¨Â∞ÜÂõûÁ≠îÊâÄÊúâÂú®ÈÇ£ÈáåÂºÄÂßãÁöÑÊü•ËØ¢ÔºåÂç≥ <span
class="math inline">\(queries[i]\)</span> ‰∏≠ÁöÑÊü•ËØ¢„ÄÇ</p>
<p>Êàë‰ª¨Â∞Ü‰ΩøÁî®‰∏Ä‰∏™ÂÖ≥‰∫éÂêëÈáèÁöÑÁ∫øÊÄßÁªÑÂêàÁöÑÁÆÄÂçï‰∫ãÂÆûÔºå‰ΩÜ‰ª•ËÅ™ÊòéÁöÑÊñπÂºèÊù•ÂõûÁ≠îËøô‰∫õÊü•ËØ¢„ÄÇÂÅáËÆæÊàë‰ª¨Â∞ÜË¶ÅÂ∞ùËØïÊèíÂÖ•
<span class="math inline">\(v\)</span> Âà∞Êàë‰ª¨ÁöÑ <span
class="math inline">\(Basis\)</span>ÔºàÂ¶ÇÊûúÁªìÊûúÊòØ‰æùËµñÁöÑËØùÔºåÂèØËÉΩ‰∏ç‰ºöÊèíÂÖ•Ôºâ„ÄÇÂ¶ÇÊûú
<span class="math inline">\(v=b_{1}+b_{2}+\dots+b_{k}\)</span>ÔºàÂÖ∂‰∏≠
<span class="math inline">\(b_{i}‚ààBasis\)</span>ÔºâÔºåÈÇ£‰πàÊàë‰ª¨ÂèØ‰ª•Âà†Èô§
<span class="math inline">\(b_i\)</span> ‰∏≠ÁöÑ‰∏Ä‰∏™ÔºåÂπ∂Â∞Ü <span
class="math inline">\(v\)</span>
ÊîæÂú®ÂÆÉÁöÑ‰ΩçÁΩÆÔºå‰øùÊåÅÂü∫ÂêëÈáè‰∏çÂèò„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨Âú®ÊèíÂÖ•Êó∂Â∞Ü‰ΩøÁî®Ëøô‰∏Ä‰∫ãÂÆû„ÄÇÊàë‰ª¨Â∞ÜÂ∞ùËØï‰øùÁïôÂü∫ÂêëÈáè‰∏≠Â∑¶Á´ØÁöÑÁ¥¢ÂºïÔºå‰ª•ÂõûÁ≠îÂ∞ΩÂèØËÉΩÂ§öÁöÑÊü•ËØ¢„ÄÇÊàë‰ª¨ÂèØ‰ª•Ë¥™Â©™Âú∞ÂÆûÁé∞Ëøô‰∏ÄÁÇπÔºöÂú®ÊèíÂÖ•
<span class="math inline">\(v\)</span> Êó∂ÔºåÊØèÂΩìÊàë‰ª¨Ë¶Å‰∏é‰∏Ä‰∫õ <span
class="math inline">\(b_i\)</span>
ËøõË°åÂºÇÊàñÊìç‰ΩúÊó∂ÔºåÊàë‰ª¨Â∞ÜÈ¶ñÂÖàÊ£ÄÊü•Âì™‰∏™Á¥¢ÂºïÊúÄÂ∞èÔºåÂ¶ÇÊûú <span
class="math inline">\(v\)</span> ÁöÑÁ¥¢ÂºïÂ∞è‰∫é <span
class="math inline">\(b_i\)</span>ÔºåÊàë‰ª¨Â∞Ü <span
class="math inline">\(swap(b_i, v)\)</span>„ÄÇÂ¶ÇÊûúÊúÄÁªàËøõË°å‰∫Ü‰∫§Êç¢ÔºåÈÇ£‰πà
<span class="math inline">\(v\)</span> Â∞ÜÊàê‰∏∫Âü∫ÂêëÈáèÁöÑ‰∏ÄÈÉ®ÂàÜÔºà‰ª£Êõø <span
class="math inline">\(b_i\)</span>ÔºâÔºåÂπ∂‰∏îÊàë‰ª¨Â∞Ü‰ΩøÁî® <span
class="math inline">\(b_i\)</span>
ËøõË°åÈ´òÊñØÊ∂àÂÖÉ„ÄÇÂê¶ÂàôÔºåÊàë‰ª¨Â∞ÜÂÉèÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ÄÊ†∑ÁªßÁª≠ËøõË°å„ÄÇÊõ¥Â§öÁªÜËäÇÔºåËØ∑ÂèÇËÄÉÈôÑÂä†ÁöÑ‰ª£Á†Å„ÄÇ</p>
<p>Áé∞Âú®ÔºåÂΩìÊàë‰ª¨ÂõûÁ≠îÂ∑¶Á´ØÁÇπ‰∏∫ <span class="math inline">\(i\)</span>
ÁöÑÊü•ËØ¢Êó∂ÔºåÊàë‰ª¨Â∞ÜÊã•ÊúâÂü∫ÂêëÈáè <span
class="math inline">\(A[i:N]\)</span>ÔºåÂÖ∂ÂÖ∑ÊúâÂèØËÉΩÁöÑÊúÄÂ∞èÁ¥¢Âºï„ÄÇÂõ†Ê≠§ÔºåÂØπ‰∫é‰∏Ä‰∏™Êü•ËØ¢
<span class="math inline">\(i\)</span> Âà∞ <span
class="math inline">\(R\)</span>ÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅËÆ°ÁÆóÂü∫ÂêëÈáè‰∏≠Á¥¢Âºï <span
class="math inline">\(‚â§R\)</span> ÁöÑÊï∞Èáè„ÄÇËøôÂèØ‰ª•ÂæàÂÆπÊòìÂú∞‰ΩøÁî®‰∏Ä‰∫õ BIT Êàñ
set ÂÆåÊàê„ÄÇ</p>
<p>ËÆ© <span class="math inline">\(K\)</span> Ë°®Á§∫ <span
class="math inline">\(\leq \sqrt{ A_{i} }\)</span> ÁöÑË¥®Êï∞ÁöÑÊï∞ÈáèÔºà<span
class="math inline">\(=225\)</span>Ôºâ„ÄÇÊàë‰ª¨‰∏∫ÊØè‰∏™Ë¥®Êï∞Â≠òÂÇ®‰∏Ä‰∏™Â§ßÂ∞è‰∏∫
<span class="math inline">\(K\)</span> ÁöÑ [[../ACM/bitset]]
„ÄÇÂú®ËøõË°åÈ´òÊñØÊ∂àÂÖÉÊó∂ÔºåÊàë‰ª¨ÊâãÂä®Â§ÑÁêÜÂ§ß‰ΩçÊï∞ÔºåÁÑ∂ÂêéÊåâÁÖßÂ∏∏ËßÑÁ®ãÂ∫èÂ§ÑÁêÜ‰ΩéÈò∂Ë¥®Êï∞ÔºõÂõ†Ê≠§ÔºåÊèíÂÖ•
<span class="math inline">\(A_i\)</span> Ëä±Ë¥π <span
class="math inline">\(O (\frac{K^2}{64})\)</span> ÁöÑÊó∂Èó¥„ÄÇ‰πãÂêéÔºåÂú® <span
class="math inline">\(O (log (N))\)</span> ÁöÑÊó∂Èó¥ÂÜÖÂõûÁ≠î <span
class="math inline">\(O (log (N))\)</span> ‰∏≠ÁöÑÊü•ËØ¢„ÄÇÂõ†Ê≠§ÔºåÊÄª‰ΩìÂ§çÊùÇÂ∫¶ÊòØ
<span class="math inline">\(O \left( N‚ãÖ \frac{k^2}{64}+Q‚ãÖlog (N)
\right)\)</span>ÔºåÁî±‰ΩøÁî® [[../ACM/bitset]] ÁöÑÈ´òÊñØÊ∂àÂÖÉÊîØÈÖç„ÄÇ</p>
<p>Reference sol in C++</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> SQRTMAX = <span class="number">3162</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> SMALL_PRIME_COUNT = <span class="number">225</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> SMALL_PRIMES[] = &#123;<span class="number">3</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">31</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">59</span>, <span class="number">67</span>, <span class="number">71</span>, <span class="number">79</span>, <span class="number">83</span>, <span class="number">103</span>, <span class="number">107</span>, <span class="number">127</span>, <span class="number">131</span>, <span class="number">139</span>, <span class="number">151</span>, <span class="number">163</span>, <span class="number">167</span>, <span class="number">179</span>, <span class="number">191</span>, <span class="number">199</span>, <span class="number">211</span>, <span class="number">223</span>, <span class="number">227</span>, <span class="number">239</span>, <span class="number">251</span>, <span class="number">263</span>, <span class="number">271</span>, <span class="number">283</span>, <span class="number">307</span>, <span class="number">311</span>, <span class="number">331</span>, <span class="number">347</span>, <span class="number">359</span>, <span class="number">367</span>, <span class="number">379</span>, <span class="number">383</span>, <span class="number">419</span>, <span class="number">431</span>, <span class="number">439</span>, <span class="number">443</span>, <span class="number">463</span>, <span class="number">467</span>, <span class="number">479</span>, <span class="number">487</span>, <span class="number">491</span>, <span class="number">499</span>, <span class="number">503</span>, <span class="number">523</span>, <span class="number">547</span>, <span class="number">563</span>, <span class="number">571</span>, <span class="number">587</span>, <span class="number">599</span>, <span class="number">607</span>, <span class="number">619</span>, <span class="number">631</span>, <span class="number">643</span>, <span class="number">647</span>, <span class="number">659</span>, <span class="number">683</span>, <span class="number">691</span>, <span class="number">719</span>, <span class="number">727</span>, <span class="number">739</span>, <span class="number">743</span>, <span class="number">751</span>, <span class="number">787</span>, <span class="number">811</span>, <span class="number">823</span>, <span class="number">827</span>, <span class="number">839</span>, <span class="number">859</span>, <span class="number">863</span>, <span class="number">883</span>, <span class="number">887</span>, <span class="number">907</span>, <span class="number">911</span>, <span class="number">919</span>, <span class="number">947</span>, <span class="number">967</span>, <span class="number">971</span>, <span class="number">983</span>, <span class="number">991</span>, <span class="number">1019</span>, <span class="number">1031</span>, <span class="number">1039</span>, <span class="number">1051</span>, <span class="number">1063</span>, <span class="number">1087</span>, <span class="number">1091</span>, <span class="number">1103</span>, <span class="number">1123</span>, <span class="number">1151</span>, <span class="number">1163</span>, <span class="number">1171</span>, <span class="number">1187</span>, <span class="number">1223</span>, <span class="number">1231</span>, <span class="number">1259</span>, <span class="number">1279</span>, <span class="number">1283</span>, <span class="number">1291</span>, <span class="number">1303</span>, <span class="number">1307</span>, <span class="number">1319</span>, <span class="number">1327</span>, <span class="number">1367</span>, <span class="number">1399</span>, <span class="number">1423</span>, <span class="number">1427</span>, <span class="number">1439</span>, <span class="number">1447</span>, <span class="number">1451</span>, <span class="number">1459</span>, <span class="number">1471</span>, <span class="number">1483</span>, <span class="number">1487</span>, <span class="number">1499</span>, <span class="number">1511</span>, <span class="number">1523</span>, <span class="number">1531</span>, <span class="number">1543</span>, <span class="number">1559</span>, <span class="number">1567</span>, <span class="number">1571</span>, <span class="number">1579</span>, <span class="number">1583</span>, <span class="number">1607</span>, <span class="number">1619</span>, <span class="number">1627</span>, <span class="number">1663</span>, <span class="number">1667</span>, <span class="number">1699</span>, <span class="number">1723</span>, <span class="number">1747</span>, <span class="number">1759</span>, <span class="number">1783</span>, <span class="number">1787</span>, <span class="number">1811</span>, <span class="number">1823</span>, <span class="number">1831</span>, <span class="number">1847</span>, <span class="number">1867</span>, <span class="number">1871</span>, <span class="number">1879</span>, <span class="number">1907</span>, <span class="number">1931</span>, <span class="number">1951</span>, <span class="number">1979</span>, <span class="number">1987</span>, <span class="number">1999</span>, <span class="number">2003</span>, <span class="number">2011</span>, <span class="number">2027</span>, <span class="number">2039</span>, <span class="number">2063</span>, <span class="number">2083</span>, <span class="number">2087</span>, <span class="number">2099</span>, <span class="number">2111</span>, <span class="number">2131</span>, <span class="number">2143</span>, <span class="number">2179</span>, <span class="number">2203</span>, <span class="number">2207</span>, <span class="number">2239</span>, <span class="number">2243</span>, <span class="number">2251</span>, <span class="number">2267</span>, <span class="number">2287</span>, <span class="number">2311</span>, <span class="number">2339</span>, <span class="number">2347</span>, <span class="number">2351</span>, <span class="number">2371</span>, <span class="number">2383</span>, <span class="number">2399</span>, <span class="number">2411</span>, <span class="number">2423</span>, <span class="number">2447</span>, <span class="number">2459</span>, <span class="number">2467</span>, <span class="number">2503</span>, <span class="number">2531</span>, <span class="number">2539</span>, <span class="number">2543</span>, <span class="number">2551</span>, <span class="number">2579</span>, <span class="number">2591</span>, <span class="number">2647</span>, <span class="number">2659</span>, <span class="number">2663</span>, <span class="number">2671</span>, <span class="number">2683</span>, <span class="number">2687</span>, <span class="number">2699</span>, <span class="number">2707</span>, <span class="number">2711</span>, <span class="number">2719</span>, <span class="number">2731</span>, <span class="number">2767</span>, <span class="number">2791</span>, <span class="number">2803</span>, <span class="number">2819</span>, <span class="number">2843</span>, <span class="number">2851</span>, <span class="number">2879</span>, <span class="number">2887</span>, <span class="number">2903</span>, <span class="number">2927</span>, <span class="number">2939</span>, <span class="number">2963</span>, <span class="number">2971</span>, <span class="number">2999</span>, <span class="number">3011</span>, <span class="number">3019</span>, <span class="number">3023</span>, <span class="number">3067</span>, <span class="number">3079</span>, <span class="number">3083</span>, <span class="number">3119</span> &#125;;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; SMALL_PRIME_ID, pow2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Fenwick1D</span> &#123; <span class="comment">// &#123;&#123;&#123;</span></span><br><span class="line">    <span class="type">int</span> size;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; T;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Fenwick1D</span>(<span class="type">int</span> maxval) &#123;</span><br><span class="line">        size = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (size &lt; maxval) size &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        T.<span class="built_in">clear</span>();</span><br><span class="line">        T.<span class="built_in">resize</span>(size+<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> delta)</span> </span>&#123; <span class="comment">// assumes 1 &lt;= x &lt;= init_maxval</span></span><br><span class="line">        <span class="keyword">while</span> (x &lt;= size) &#123; T[x] += delta; x += x &amp; -x; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> x1, <span class="type">int</span> x2)</span> </span>&#123; <span class="comment">// sum in the closed interval [x1,x2]</span></span><br><span class="line">        <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">        --x1;</span><br><span class="line">        <span class="keyword">while</span> (x2) &#123; res += T[x2]; x2 -= x2 &amp; -x2; &#125;</span><br><span class="line">        <span class="keyword">while</span> (x1) &#123; res -= T[x1]; x1 -= x1 &amp; -x1; &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> sum)</span> </span>&#123; <span class="comment">// largest z such that sum( [1,z] ) &lt;= sum</span></span><br><span class="line">        <span class="type">int</span> idx = <span class="number">0</span>, bitMask = size;</span><br><span class="line">        <span class="keyword">while</span> (bitMask &amp;&amp; (idx &lt; size)) &#123;</span><br><span class="line">            <span class="type">int</span> tIdx = idx + bitMask;</span><br><span class="line">            <span class="keyword">if</span> (sum &gt;= T[tIdx]) &#123; idx=tIdx; sum -= T[tIdx]; &#125;</span><br><span class="line">            bitMask &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> idx;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;; <span class="comment">// &#125;&#125;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    SMALL_PRIME_ID.<span class="built_in">clear</span>();</span><br><span class="line">    SMALL_PRIME_ID.<span class="built_in">resize</span>(SQRTMAX+<span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;SMALL_PRIME_COUNT; ++i) SMALL_PRIME_ID[ SMALL_PRIMES[i] ] = i;</span><br><span class="line">    pow2.<span class="built_in">clear</span>();</span><br><span class="line">    pow2.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;<span class="number">100005</span>; ++i) pow2.<span class="built_in">push_back</span>( (pow2.<span class="built_in">back</span>()*<span class="number">2</span>) % <span class="number">998244353</span> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">signature</span> &#123;</span><br><span class="line">    bitset&lt; SMALL_PRIME_COUNT &gt; small_bits;</span><br><span class="line">    <span class="type">int</span> large_bit;</span><br><span class="line">    <span class="built_in">signature</span>() : <span class="built_in">large_bit</span>(<span class="number">-1</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">highest_prime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (large_bit != <span class="number">-1</span>) <span class="keyword">return</span> large_bit;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=SMALL_PRIME_COUNT<span class="number">-1</span>; i&gt;=<span class="number">0</span>; --i) <span class="keyword">if</span> (small_bits.<span class="built_in">test</span>(i)) <span class="keyword">return</span> SMALL_PRIMES[i];</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">do_xor</span><span class="params">(<span class="type">const</span> signature &amp;other)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (other.large_bit != <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (large_bit != <span class="number">-1</span>) &#123;</span><br><span class="line">                <span class="built_in">assert</span>( large_bit == other.large_bit );</span><br><span class="line">                large_bit = <span class="number">-1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                large_bit = other.large_bit;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        small_bits ^= other.small_bits;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ostream&amp; <span class="keyword">operator</span>&lt;&lt; (ostream&amp; out, <span class="type">const</span> signature &amp;S) &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    int max = SMALL_PRIME_COUNT - 1;</span></span><br><span class="line"><span class="comment">    while (max &gt; 0 &amp;&amp; !S.small_bits.test(max)) --max;</span></span><br><span class="line"><span class="comment">    for (int i=0; i&lt;=max; ++i) out &lt;&lt; int( S.small_bits.test(i) );</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span> (S.large_bit != <span class="number">-1</span>) out &lt;&lt; S.large_bit &lt;&lt; <span class="string">&quot;+&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">9</span>; i&gt;=<span class="number">0</span>; --i) out &lt;&lt; <span class="built_in">int</span>(S.small_bits.<span class="built_in">test</span>(i));</span><br><span class="line">    <span class="keyword">return</span> out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">query</span> &#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> <span class="keyword">operator</span>&lt; (<span class="type">const</span> query &amp;A, <span class="type">const</span> query &amp;B) &#123;</span><br><span class="line">    <span class="keyword">if</span> (A.l != B.l) <span class="keyword">return</span> A.l &gt; B.l;</span><br><span class="line">    <span class="keyword">return</span> A.r &lt; B.r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">signature <span class="title">get_signature</span><span class="params">(<span class="type">int</span> N)</span> </span>&#123;</span><br><span class="line">    signature answer;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> d=<span class="number">2</span>; d*d&lt;=N; ++d) &#123;</span><br><span class="line">        <span class="keyword">if</span> (N % d) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (N % d == <span class="number">0</span>) &#123; ++cnt; N /= d; &#125;</span><br><span class="line">        <span class="keyword">if</span> (d % <span class="number">4</span> != <span class="number">3</span>) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (cnt % <span class="number">2</span> == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">        answer.small_bits.<span class="built_in">set</span>( SMALL_PRIME_ID[d] );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (N &gt; <span class="number">1</span> &amp;&amp; N % <span class="number">4</span> == <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (N &gt; SQRTMAX) answer.large_bit = N; <span class="keyword">else</span> answer.small_bits.<span class="built_in">set</span>( SMALL_PRIME_ID[N] );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> answer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TaleOfTwoSquares</span> &#123;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">count</span><span class="params">(<span class="type">int</span> N, vector&lt;<span class="type">int</span>&gt; Aprefix, <span class="type">int</span> Q, vector&lt;<span class="type">int</span>&gt; Lprefix, vector&lt;<span class="type">int</span>&gt; Rprefix, <span class="type">int</span> seed)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">init</span>();</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> state = seed;</span><br><span class="line"></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; A = Aprefix;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">int</span>(A.<span class="built_in">size</span>()) &lt; N) &#123;</span><br><span class="line">            state = (state * <span class="number">1103515245</span> + <span class="number">12345</span>) % (<span class="number">1LL</span> &lt;&lt; <span class="number">31</span>);</span><br><span class="line">            A.<span class="built_in">push_back</span>(<span class="number">1</span> + (state % <span class="number">10000000</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (N &lt;= <span class="number">20</span>) <span class="keyword">for</span> (<span class="type">int</span> n=<span class="number">0</span>; n&lt;N; ++n) cout &lt;&lt; A[n] &lt;&lt; <span class="string">&quot;, &quot;</span>; cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; L = Lprefix, R = Rprefix;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">int</span>(L.<span class="built_in">size</span>()) &lt; Q) &#123;</span><br><span class="line">            state = (state * <span class="number">1103515245</span> + <span class="number">12345</span>) % (<span class="number">1LL</span> &lt;&lt; <span class="number">31</span>);</span><br><span class="line">            <span class="type">int</span> x = state % N;</span><br><span class="line">            state = (state * <span class="number">1103515245</span> + <span class="number">12345</span>) % (<span class="number">1LL</span> &lt;&lt; <span class="number">31</span>);</span><br><span class="line">            <span class="type">int</span> y = state % N;</span><br><span class="line">            L.<span class="built_in">push_back</span>( <span class="built_in">min</span>(x,y) );</span><br><span class="line">            R.<span class="built_in">push_back</span>( <span class="built_in">max</span>(x,y) );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (Q &lt;= <span class="number">20</span>) <span class="keyword">for</span> (<span class="type">int</span> n=<span class="number">0</span>; n&lt;Q; ++n) cout &lt;&lt; L[n] &lt;&lt; <span class="string">&quot;, &quot;</span>; cout &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">if</span> (Q &lt;= <span class="number">20</span>) <span class="keyword">for</span> (<span class="type">int</span> n=<span class="number">0</span>; n&lt;Q; ++n) cout &lt;&lt; R[n] &lt;&lt; <span class="string">&quot;, &quot;</span>; cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">        vector&lt;signature&gt; B;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> n=<span class="number">0</span>; n&lt;N; ++n) B.<span class="built_in">push_back</span>( <span class="built_in">get_signature</span>(A[n]) );</span><br><span class="line"></span><br><span class="line">        vector&lt; vector&lt;<span class="type">int</span>&gt; &gt; <span class="built_in">query_by_L</span>(N);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> q=<span class="number">0</span>; q&lt;Q; ++q) query_by_L[ L[q] ].<span class="built_in">push_back</span>( R[q] );</span><br><span class="line"></span><br><span class="line">        <span class="function">Fenwick1D <span class="title">InBase</span><span class="params">(N+<span class="number">2</span>)</span></span>;</span><br><span class="line">        <span class="type">int</span> answer = <span class="number">0</span>;</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>,<span class="type">int</span>&gt; base_by_highest_prime;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> n=N<span class="number">-1</span>; n&gt;=<span class="number">0</span>; --n) &#123;</span><br><span class="line">            <span class="comment">// two dummy updates</span></span><br><span class="line">            InBase.<span class="built_in">update</span>(N+<span class="number">1</span>,+<span class="number">1</span>);</span><br><span class="line">            InBase.<span class="built_in">update</span>(N+<span class="number">1</span>,<span class="number">-1</span>);</span><br><span class="line">            <span class="comment">// add number A[n] to the base</span></span><br><span class="line">            <span class="keyword">if</span> (B[n].<span class="built_in">highest_prime</span>() != <span class="number">0</span>) &#123;</span><br><span class="line">                InBase.<span class="built_in">update</span>(n+<span class="number">1</span>,+<span class="number">1</span>);</span><br><span class="line">                <span class="type">int</span> where = n;</span><br><span class="line">                <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                    <span class="type">int</span> p = B[where].<span class="built_in">highest_prime</span>();</span><br><span class="line">                    <span class="keyword">if</span> (p == <span class="number">0</span>) &#123;</span><br><span class="line">                        InBase.<span class="built_in">update</span>(where+<span class="number">1</span>,<span class="number">-1</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (!base_by_highest_prime.<span class="built_in">count</span>(p)) &#123;</span><br><span class="line">                        base_by_highest_prime[p] = where;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="type">int</span> nxt = base_by_highest_prime[p];</span><br><span class="line">                    <span class="keyword">if</span> (nxt &gt; where) &#123;</span><br><span class="line">                        base_by_highest_prime[p] = where;</span><br><span class="line">                        B[nxt].<span class="built_in">do_xor</span>( B[where] );</span><br><span class="line">                        where = nxt;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        B[where].<span class="built_in">do_xor</span>( B[nxt] );</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// answer queries that begin here</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> r : query_by_L[n]) &#123;</span><br><span class="line">                <span class="type">int</span> length = r-n+<span class="number">1</span>;</span><br><span class="line">                <span class="type">int</span> base_size = InBase.<span class="built_in">sum</span>(n+<span class="number">1</span>,r+<span class="number">1</span>);</span><br><span class="line">                answer += pow2[length-base_size] - <span class="number">1</span>;</span><br><span class="line">                answer %= <span class="number">998244353</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> answer;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

    </div>

    
    
    <div class="post-widgets">
      <div id="needsharebutton-postbottom">
        <span class="btn">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </span>
      </div>
    </div>
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Êú¨Êñá‰ΩúËÄÖÔºö </strong>FXJFXJ
  </li>
  <li class="post-copyright-link">
    <strong>Êú¨ÊñáÈìæÊé•Ôºö</strong>
    <a href="https://fxj.wiki/posts/d6976ad7/" title="Single Round Match 790 Editorials - Topcoder">https://fxj.wiki/posts/d6976ad7/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ÁâàÊùÉÂ£∞ÊòéÔºö </strong>Êú¨ÂçöÂÆ¢ÊâÄÊúâÊñáÁ´†Èô§ÁâπÂà´Â£∞ÊòéÂ§ñÔºåÂùáÈááÁî® <a href="https://creativecommons.org/publicdomain/zero/1.0/en" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>ZERO</a> ËÆ∏ÂèØÂçèËÆÆ„ÄÇËΩ¨ËΩΩËØ∑Ê≥®ÊòéÂá∫Â§ÑÔºÅ
  </li>
</ul>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/div2/" rel="tag"><i class="fa fa-tag"></i> div2</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/eef20e6f/" rel="prev" title="ACM ÁöÑÊ≠£Á°ÆÂÖ•Èó®ÊñπÂºèÊòØ‰ªÄ‰πàÔºü">
      <i class="fa fa-chevron-left"></i> ACM ÁöÑÊ≠£Á°ÆÂÖ•Èó®ÊñπÂºèÊòØ‰ªÄ‰πàÔºü
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/b9ef90d5/" rel="next" title="ÊµÖË∞àÂü∫ÁéØÊ†ëÔºàÁéØÂ•óÊ†ëÔºâ">
      ÊµÖË∞àÂü∫ÁéØÊ†ëÔºàÁéØÂ•óÊ†ëÔºâ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          ÊñáÁ´†ÁõÆÂΩï
        </li>
        <li class="sidebar-nav-overview">
          Á´ôÁÇπÊ¶ÇËßà
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#div2-medium-bob-the-builder"><span class="nav-text">Div2-Medium: Bob the Builder</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#div2-hard-div1-easy-the-social-network"><span class="nav-text">Div2-Hard &#x2F; Div1-Easy:
The Social Network</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#div1-medium-proposal-optimization"><span class="nav-text">Div1-Medium: Proposal
Optimization</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#div1-hard-tale-of-two-squares"><span class="nav-text">Div1-Hard: Tale Of Two
Squares:</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="FXJFXJ"
      src="/images/8e78b9e9e316fb38c4483af628530815.jpg">
  <p class="site-author-name" itemprop="name">FXJFXJ</p>
  <div class="site-description" itemprop="description">A story about ACMer and Programmerüòá</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">131</span>
          <span class="site-state-item-name">Êó•Âøó</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">ÂàÜÁ±ª</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">41</span>
        <span class="site-state-item-name">Ê†áÁ≠æ</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/bakebakebakebake" title="GitHub ‚Üí https:&#x2F;&#x2F;github.com&#x2F;bakebakebakebake" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="qq:fxjgo@qq.com" title="E-Mail ‚Üí qq:fxjgo@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://stackoverflow.com/users/22060498/fxjfxj" title="StackOverflow ‚Üí https:&#x2F;&#x2F;stackoverflow.com&#x2F;users&#x2F;22060498&#x2F;fxjfxj" rel="noopener" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>StackOverflow</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/2071277173?spm_id_from=333.1007.0.0" title="Bilibili ‚Üí https:&#x2F;&#x2F;space.bilibili.com&#x2F;2071277173?spm_id_from&#x3D;333.1007.0.0" rel="noopener" target="_blank"><i class="iconfont icon-bilibili-line fa-fw"></i>Bilibili</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.nowcoder.com/users/856358952" title="Nowcoder ‚Üí https:&#x2F;&#x2F;www.nowcoder.com&#x2F;users&#x2F;856358952" rel="noopener" target="_blank"><i class="fab fa-freebsd fa-fw"></i>Nowcoder</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/4-95-22-83" title="Zhihu ‚Üí https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;4-95-22-83" rel="noopener" target="_blank"><i class="fab fa-zhihu fa-fw"></i>Zhihu</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://atcoder.jp/users/FXJFXJ" title="AtCoder ‚Üí https:&#x2F;&#x2F;atcoder.jp&#x2F;users&#x2F;FXJFXJ" rel="noopener" target="_blank"><i class="fab fa-wolf-pack-battalion fa-fw"></i>AtCoder</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://codeforces.com/profile/FXJFXJ" title="Codeforces ‚Üí https:&#x2F;&#x2F;codeforces.com&#x2F;profile&#x2F;FXJFXJ" rel="noopener" target="_blank"><i class="fab fa-grav fa-fw"></i>Codeforces</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/publicdomain/zero/1.0/en" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-zero.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Friend Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://github.com/bakebakebakebake" title="https:&#x2F;&#x2F;github.com&#x2F;bakebakebakebake" rel="noopener" target="_blank">TestLink</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">ËúÄICPÂ§á2024053343Âè∑-1 </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">FXJFXJ</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">Á´ôÁÇπÊÄªÂ≠óÊï∞Ôºö</span>
    <span title="Á´ôÁÇπÊÄªÂ≠óÊï∞">180k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">Á´ôÁÇπÈòÖËØªÊó∂Èïø &asymp;</span>
    <span title="Á´ôÁÇπÈòÖËØªÊó∂Èïø">10:54</span>
</div><script color="0,0,255" opacity="0.5" zIndex="-1" count="99" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"></script>

<div>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_pv" style='display:none'>
    Êú¨Á´ôÊÄªËÆøÈóÆÈáè <span id="busuanzi_value_site_pv"></span> Ê¨°
    <span class="post-meta-divider">|</span>
</span>
<span id="busuanzi_container_site_uv" style='display:none'>
    Êúâ<span id="busuanzi_value_site_uv"></span>‰∫∫ÁúãËøáÊàëÁöÑÂçöÂÆ¢
</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="ÊÄªËÆøÂÆ¢Èáè">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="ÊÄªËÆøÈóÆÈáè">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script size="300" alpha="0.6" zIndex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>



<script src="/js/code-unfold.js"></script>
  
  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

<script>
var options = {
  bottom: '64px',
  right: 'unset',
  left: '32px',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: 'üåì',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script>

  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.js"></script>
  <script>
      pbOptions = {};
        pbOptions.iconStyle = "box";
        pbOptions.boxForm = "horizontal";
        pbOptions.position = "bottomCenter";
        pbOptions.networks = "Wechat,QQZone,Weibo,Douban,Twitter,Facebook";
      new needShareButton('#needsharebutton-postbottom', pbOptions);
  </script>
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '68555ce0994478cbe4b2',
      clientSecret: '7fc441c67a52788e5da104489ac9326d2fb32d65',
      repo        : 'bakebakebakebake.github.io',
      owner       : 'bakebakebakebake',
      admin       : ['bakebakebakebake'],
      id          : 'fb02c129e47d094527227b1ae0baada5',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
